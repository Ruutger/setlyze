

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>setlyze.database — Database access &mdash; SETLyze 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SETLyze 1.0 documentation" href="../index.html" />
    <link rel="up" title="SETLyze Standard Modules" href="../setlyze_modules.html" />
    <link rel="next" title="setlyze.gui — Graphical interfaces" href="gui.html" />
    <link rel="prev" title="setlyze.config — Configuration manager" href="config.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gui.html" title="setlyze.gui — Graphical interfaces"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="config.html" title="setlyze.config — Configuration manager"
             accesskey="P">previous</a> |</li>
    <li><a href="../gimaris.html">GiMaRIS</a> &raquo;</li>
    
        <li><a href="../index.html">SETLyze 1.0 documentation</a> &raquo;</li>

          <li><a href="../developer_guide.html" >SETLyze Developer Guide</a> &raquo;</li>
          <li><a href="../setlyze_modules.html" accesskey="U">SETLyze Standard Modules</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="setlyze-database-database-access">
<h1><a class="reference internal" href="#module-setlyze.database" title="setlyze.database"><tt class="xref py py-mod docutils literal"><span class="pre">setlyze.database</span></tt></a> &#8212; Database access<a class="headerlink" href="#setlyze-database-database-access" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Serrano Pereira, Adam van Adrichem, Fedde Schaeffer</td>
</tr>
<tr class="field-even field"><th class="field-name">Release:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">April 15, 2013</td>
</tr>
</tbody>
</table>
<div class="section" id="module-setlyze.database">
<span id="module-contents"></span><h2>Module Contents<a class="headerlink" href="#module-setlyze.database" title="Permalink to this headline">¶</a></h2>
<p>Facilitate access to the database.</p>
<p>The local SQLite database is created by <a class="reference internal" href="#setlyze.database.MakeLocalDB.create_new_db" title="setlyze.database.MakeLocalDB.create_new_db"><tt class="xref py py-meth docutils literal"><span class="pre">setlyze.database.MakeLocalDB.create_new_db()</span></tt></a>.
It is created using Python&#8217;s SQLite module and is used internally by SETLyze
for storing and retrieving data for analyses. The database is a single file
created in the user&#8217;s home directory in a subfolder called <tt class="docutils literal"><span class="pre">.setlyze</span></tt>.</p>
<p>There are plans to create a central SETL database server which this module
can interact with. We refer to this database as the remote database.</p>
<dl class="class">
<dt id="setlyze.database.AccessDBGeneric">
<em class="property">class </em><tt class="descclassname">setlyze.database.</tt><tt class="descname">AccessDBGeneric</tt><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Super class for <a class="reference internal" href="#setlyze.database.AccessLocalDB" title="setlyze.database.AccessLocalDB"><tt class="xref py py-class docutils literal"><span class="pre">AccessLocalDB</span></tt></a> and <a class="reference internal" href="#setlyze.database.AccessRemoteDB" title="setlyze.database.AccessRemoteDB"><tt class="xref py py-class docutils literal"><span class="pre">AccessRemoteDB</span></tt></a>.</p>
<p>This class contains methods that are generic for both sub-classes.
It provides both sub classes with methods for data that is always
present in the local database.</p>
<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.fill_plate_spot_totals_table">
<tt class="descname">fill_plate_spot_totals_table</tt><big>(</big><em>spots_table1</em>, <em>spots_table2=None</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.fill_plate_spot_totals_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.fill_plate_spot_totals_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate table &#8220;plate_spot_totals&#8221;.</p>
<p>This table is populated with the number of positive spots for each
plate. The information is obtained from the spots tables <cite>spots_table1</cite>
and optionally <cite>spots_table2</cite>.</p>
<p>The &#8220;plate_spot_totals&#8221; table is used in several situations:</p>
<blockquote>
<div><ul class="simple">
<li>Calculating the expected distances, where the positive spot
number serves as a template for the random spots generator
(see <a class="reference internal" href="std.html#setlyze.std.get_random_for_plate" title="setlyze.std.get_random_for_plate"><tt class="xref py py-meth docutils literal"><span class="pre">get_random_for_plate()</span></tt></a>).</li>
<li>Significance calculators, where the tests are applied to
plates with a specific number of positive spots (see
<a class="reference internal" href="#setlyze.database.AccessDBGeneric.get_distances_matching_spots_total" title="setlyze.database.AccessDBGeneric.get_distances_matching_spots_total"><tt class="xref py py-meth docutils literal"><span class="pre">get_distances_matching_spots_total()</span></tt></a>).</li>
</ul>
</div></blockquote>
<p>If just <cite>spots_table1</cite> is provided, only the column &#8220;n_spots_a&#8221;
is populated with positive spot numbers. If both <cite>spots_table1</cite> and
<cite>spots_table2</cite> are provided, column &#8220;n_spots_a&#8221; is filled
from <cite>spots_table1</cite>, and column &#8220;n_spots_b&#8221; filled from <cite>spots_table2</cite>.</p>
<p>Returns a tuple (<cite>rows affected</cite>, <cite>rows skipped</cite>).</p>
<p>Design Part: 1.73</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_area_totals">
<tt class="descname">get_area_totals</tt><big>(</big><em>plate_area_totals_table</em>, <em>area_group</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_area_totals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_area_totals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return total number of positive spots per area group per plate.</p>
<p>Argument <cite>plate_area_totals_table</cite> is either
<tt class="docutils literal"><span class="pre">plate_area_totals_observed</span></tt> or <tt class="docutils literal"><span class="pre">plate_area_totals_expected</span></tt>.
The area group <cite>area_group</cite> can be a sequence containing a
combination of the letters A, B, C, and D. Each letter is one of
the default areas on a SETL plate.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_database_info">
<tt class="descname">get_database_info</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_database_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_database_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return database information.</p>
<p>These include the creation date and the data source.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_distances_matching_ratios">
<tt class="descname">get_distances_matching_ratios</tt><big>(</big><em>distance_table</em>, <em>ratios</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_distances_matching_ratios"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_distances_matching_ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the spot distances from distance table <cite>distance_table</cite> where
positive spots numbers between species A and B have ratio
matching the list of ratios <cite>ratios</cite>.</p>
<p>The ratio A:B is considered the same as B:A.</p>
<p>This is a generator, meaning that this method returns an
iterator. This iterator returns the distances.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_distances_matching_spots_total">
<tt class="descname">get_distances_matching_spots_total</tt><big>(</big><em>distance_table</em>, <em>spots_n</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_distances_matching_spots_total"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_distances_matching_spots_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the distances from distance table <cite>distance_table</cite> that
are from plates having <cite>spots_n</cite> positive spot numbers.</p>
<p>This is a generator, meaning that this method returns an
iterator. This iterator returns the distances.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_locations">
<tt class="descname">get_locations</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_locations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_locations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all locations from the local database.</p>
<p>Returns a list of tuples <tt class="docutils literal"><span class="pre">(loc_id,</span> <span class="pre">'loc_name')</span></tt>.</p>
<p>Design Part: 1.95</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.get_plates_total_matching_spots_total">
<tt class="descname">get_plates_total_matching_spots_total</tt><big>(</big><em>n_spots</em>, <em>slot=0</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.get_plates_total_matching_spots_total"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.get_plates_total_matching_spots_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of plates that match the provided number of
positive spots <cite>n_spots</cite>.</p>
<p>Possible values for <cite>slot</cite> are 0 for the first species selection,
and 1 for the second species selection.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessDBGeneric.make_plates_unique">
<tt class="descname">make_plates_unique</tt><big>(</big><em>slot</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessDBGeneric.make_plates_unique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessDBGeneric.make_plates_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the records with the same plate ID in a spots table.</p>
<p>The value for <cite>slot</cite> defines which spots table is used.
The possible values of <cite>slot</cite> are <tt class="docutils literal"><span class="pre">0</span></tt> for table
&#8220;species_spots_1&#8221; and <tt class="docutils literal"><span class="pre">1</span></tt> for table &#8220;species_spots_2&#8221;.</p>
<p>We&#8217;re doing this so we can threat multiple species selected by
the user as a single species.</p>
<p>Returns the total numbers of distinctive plates.</p>
<p>Design Part: 1.20</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="setlyze.database.AccessLocalDB">
<em class="property">class </em><tt class="descclassname">setlyze.database.</tt><tt class="descname">AccessLocalDB</tt><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide standard methods for accessing data in the local
SQLite database. These methods are only used when the data source
is set to <tt class="docutils literal"><span class="pre">data-files</span></tt>.</p>
<p>Inherits from <a class="reference internal" href="#setlyze.database.AccessDBGeneric" title="setlyze.database.AccessDBGeneric"><tt class="xref py py-class docutils literal"><span class="pre">AccessDBGeneric</span></tt></a> which provides this
class with methods that are not data source specific.</p>
<p>Design Part: 1.28</p>
<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_plate_area_totals_expected">
<tt class="descname">create_table_plate_area_totals_expected</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_plate_area_totals_expected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_plate_area_totals_expected" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;plate_area_totals_expected&#8221;.</p>
<p>This table is used to store the total of expected positive spots per
plate area per plate ID.</p>
<p>Design Part: TODO</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_plate_area_totals_observed">
<tt class="descname">create_table_plate_area_totals_observed</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_plate_area_totals_observed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_plate_area_totals_observed" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;plate_area_totals_observed&#8221;.</p>
<p>This table is used to store the total of positive spots per plate area
per plate ID.</p>
<p>Design Part:</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_plate_spot_totals">
<tt class="descname">create_table_plate_spot_totals</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_plate_spot_totals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_plate_spot_totals" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;plate_spot_totals&#8221;.</p>
<p>This table is used to store the total of spots per plate.</p>
<p>Design Part: 1.85
Creates Design Part: 2.39</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_species_spots_1">
<tt class="descname">create_table_species_spots_1</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_species_spots_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_species_spots_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;species_spots_1&#8221;.</p>
<p>This table will contain the SETL records for the first species
selection.</p>
<p>Because the user can select multiple species, the plate IDs in column
&#8220;rec_pla_id&#8221; don&#8217;t have to be unique, so we&#8217;re creating a separate
column &#8220;id&#8221; as the primary key.</p>
<p>Design Part: 1.80
Creates Design Part: 2.9, 2.9.1, 2.9.2</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_species_spots_2">
<tt class="descname">create_table_species_spots_2</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_species_spots_2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_species_spots_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;species_spots_2&#8221;.</p>
<p>This table will contain the SETL records for the second species
selection.</p>
<dl class="docutils">
<dt>Because the user can select multiple species, the plate IDs in column</dt>
<dd>&#8220;rec_pla_id&#8221; don&#8217;t have to be unique, so we&#8217;re creating a separate
column &#8220;id&#8221; as the primary key.</dd>
</dl>
<p>Design Part: 1.81
Creates Design Part: 2.10, 2.10.1, 2.10.2</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_spot_distances_expected">
<tt class="descname">create_table_spot_distances_expected</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_spot_distances_expected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_spot_distances_expected" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;spot_distances_expected&#8221;.</p>
<p>This table is used to store expected spot distances.</p>
<p>Design Part: 1.84
Creates Design Part: 2.13</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.create_table_spot_distances_observed">
<tt class="descname">create_table_spot_distances_observed</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.create_table_spot_distances_observed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.create_table_spot_distances_observed" title="Permalink to this definition">¶</a></dt>
<dd><p>Create temporary table &#8220;spot_distances_observed&#8221;.</p>
<p>This table is used to store observed spot distances.</p>
<p>Design Part: 1.83
Creates Design Part: 2.12</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.get_record_ids">
<tt class="descname">get_record_ids</tt><big>(</big><em>locations</em>, <em>species</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.get_record_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.get_record_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Return records that match the locations and species selections.</p>
<p>Returns a list of record IDs that match the locations IDs
in the list <cite>locations</cite> and the species IDs in the list <cite>species</cite>.</p>
<p>Both <cite>locations</cite> and <cite>species</cite> can be an integer instead of a list with
a single integer.</p>
<p>Design Part: 1.41</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.get_species">
<tt class="descname">get_species</tt><big>(</big><em>locations</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.get_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.get_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Return species that match a locations selection <cite>locations</cite>.</p>
<p>Species are returned as tuples in the format
<tt class="docutils literal"><span class="pre">(id,</span> <span class="pre">'common_name',</span> <span class="pre">'latin_name')</span></tt>. Argument <cite>locations</cite> is a list
of location IDs.</p>
<p>Design Part: 1.96</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.get_spots">
<tt class="descname">get_spots</tt><big>(</big><em>rec_ids</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.get_spots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.get_spots" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all 25 spot booleans for the records with IDs matching
the list of record IDs <cite>rec_ids</cite>.</p>
<p>This is a generator, meaning that this method returns an
iterator. This iterator returns tuples with the 25 spot booleans for
all matching records.</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.AccessLocalDB.set_species_spots">
<tt class="descname">set_species_spots</tt><big>(</big><em>rec_ids</em>, <em>slot</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#AccessLocalDB.set_species_spots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessLocalDB.set_species_spots" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a table in the local database containing the spots
information for SETL records matching <cite>rec_ids</cite>. Two spots
tables can be created. The values for <cite>slot</cite> can be <tt class="docutils literal"><span class="pre">0</span></tt> for table
<tt class="docutils literal"><span class="pre">species_spots_1</span></tt> and <tt class="docutils literal"><span class="pre">1</span></tt> for <tt class="docutils literal"><span class="pre">species_spots_2</span></tt>.</p>
<p>Each record in the spots table consists of the plate ID followed
by the 25 spot booleans.</p>
<p>Design Part: 1.19.1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="setlyze.database.AccessRemoteDB">
<em class="property">class </em><tt class="descclassname">setlyze.database.</tt><tt class="descname">AccessRemoteDB</tt><a class="reference internal" href="../_modules/setlyze/database.html#AccessRemoteDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.AccessRemoteDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide standard methods for accessing data in the remote
PostgreSQL SETL database. These methods are only used when the data
source is set to <tt class="docutils literal"><span class="pre">setl-database</span></tt>.</p>
<p>Inherits from <a class="reference internal" href="#setlyze.database.AccessDBGeneric" title="setlyze.database.AccessDBGeneric"><tt class="xref py py-class docutils literal"><span class="pre">AccessDBGeneric</span></tt></a> which provides this
class with methods that are not data source specific.</p>
<p>Design Part: 1.29</p>
</dd></dl>

<dl class="class">
<dt id="setlyze.database.MakeLocalDB">
<em class="property">class </em><tt class="descclassname">setlyze.database.</tt><tt class="descname">MakeLocalDB</tt><big>(</big><em>pd=None</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a local SQLite database with default tables and fill some
tables based on the data source.</p>
<p>This class can load data from three data sources. One data source is user
supplied CSV files containing SETL data. The CSV files must be exported by
the MS Access SETL database. The second source is the PostgreSQL SETL
database. This function requires a direct connection with the SETL database
server. The third source are XLS files containing SETL data. These files
must be exported by MS Excel 97/2000/xp.</p>
<p>Because the import of SETL data into the local database can take a while,
and instance of this class must run in a separate thread. An instance of
this class is therefor a thread object.</p>
<p>Once a thread object is created, its activity must be started by calling
the thread&#8217;s start() method. This invokes the <a class="reference internal" href="#setlyze.database.MakeLocalDB.run" title="setlyze.database.MakeLocalDB.run"><tt class="xref py py-meth docutils literal"><span class="pre">run()</span></tt></a> method in a
separate thread of control.</p>
<p>Design Part: 1.2</p>
<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_new_db">
<tt class="descname">create_new_db</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_new_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_new_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new local database.</p>
<p>This deletes any existing database file.</p>
<p>Design Part: 1.38</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_table_info">
<tt class="descname">create_table_info</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_table_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_table_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the &#8220;info&#8221; table for storing general information.</p>
<p>This information includes its creation date and the data source.
The data source is either the SETL database (MS Access/PostgreSQL)
or XLS/CSV files containing SETL data. A version number for the
database is also saved. This could be handy in the future,
for example we can notify the user if the local database is
too old, followed by creating a new local database.</p>
<p>Design Part: 1.75</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_table_localities">
<tt class="descname">create_table_localities</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_table_localities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_table_localities" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the &#8220;localities&#8221; table for the SETL locations.</p>
<p>Because the data from this table is accessed frequently, the
localities records are automatically saved to this table when
an analyze is started.</p>
<p>Design Part: 1.76</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_table_plates">
<tt class="descname">create_table_plates</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_table_plates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_table_plates" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the &#8220;plates&#8221; table for the SETL plates.</p>
<p>This table is only filled if the user selected CSV or XLS files to
import SETL data from. If the remote SETL database is used,
the plate records are obtained directly via queries.</p>
<p>Design Part: 1.78</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_table_records">
<tt class="descname">create_table_records</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_table_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_table_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the &#8220;records&#8221; table for the SETL records.</p>
<p>This table is only filled if the user selected CSV or XLS files to
import SETL data from. If the remote SETL database is used,
the records are obtained directly via queries.</p>
<p>Design Part: 1.79</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.create_table_species">
<tt class="descname">create_table_species</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.create_table_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.create_table_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the &#8220;species&#8221; table for the SETL species.</p>
<p>Because the data from this table is accessed frequently, the
species records are automatically saved to this table when
an analyze is started.</p>
<p>Design Part: 1.77</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_from_data_files">
<tt class="descname">insert_from_data_files</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_from_data_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_from_data_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new local database and load all SETL data from user
selected CSV or Excel files into the local database.</p>
<p>The SETL data is loaded from four separate files:</p>
<ul class="simple">
<li>Locations file, containing the SETL locations.</li>
<li>Species ile, containing the SETL species.</li>
<li>Records file, containing the SETL records.</li>
<li>Plates file, containing the SETL plates.</li>
</ul>
<p>These files can be exported from the MS Access SETL database
and contain all fields. CSV files must be delimited by semicolons (;)
and double quotes (&#8221;) as the quote character for fields with special
characters. Excel (*.xls) files must have the same format as the CSV
files and must not have a header.</p>
<p>Design Part: 1.32</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_from_db">
<tt class="descname">insert_from_db</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_from_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_from_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new local database and load localities and species
data from the remote SETL database into the local database.</p>
<p>This method requires a direct connection with the SETL
database server.</p>
<p>The reason why we don&#8217;t load all SETL data into the local database
is because we can execute queries on the remote database. So
there&#8217;s no need to load large amounts of data onto the user&#8217;s
computer. Because the localities and species data is accessed
often, loading this into the local database increases speed of
the application.</p>
<p>Design Part: 1.33</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_locations_from_csv">
<tt class="descname">insert_locations_from_csv</tt><big>(</big><em>filename</em>, <em>delimiter=';'</em>, <em>quotechar='&quot;'</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_locations_from_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_locations_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the SETL localities from a CSV file into the local
database.</p>
<p>Argument <cite>delimiter</cite> is a one-character string used to separate fields
in the CSV file, and <cite>quotechar</cite> is a one-character string used to
quote fields containing special characters in the CSV file. The default
values for these two arguments are suited for CSV files in Excel
format.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-18"><em>2.18</em></a>.</p>
<p>Design Part: 1.34</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_locations_from_xls">
<tt class="descname">insert_locations_from_xls</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_locations_from_xls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_locations_from_xls" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the SETL localities from a XLS file into the local
database.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-18"><em>2.18</em></a>.</p>
<p>Design Part: TODO</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_plates_from_csv">
<tt class="descname">insert_plates_from_csv</tt><big>(</big><em>filename</em>, <em>delimiter=';'</em>, <em>quotechar='&quot;'</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_plates_from_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_plates_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the plates from a CSV file into the local database.</p>
<p>Argument <cite>delimiter</cite> is a one-character string used to separate fields
in the CSV file, and <cite>quotechar</cite> is a one-character string used to
quote fields containing special characters in the CSV file. The default
values for these two arguments are suited for CSV files in Excel
format.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-20"><em>2.20</em></a>.</p>
<p>Design Part: 1.36</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_plates_from_xls">
<tt class="descname">insert_plates_from_xls</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_plates_from_xls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_plates_from_xls" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the plates from a XLS file into the local database.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-20"><em>2.20</em></a>.</p>
<p>Design Part: TODO</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_records_from_csv">
<tt class="descname">insert_records_from_csv</tt><big>(</big><em>filename</em>, <em>delimiter=';'</em>, <em>quotechar='&quot;'</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_records_from_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_records_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the records from a CSV file into the local database.</p>
<p>Argument <cite>delimiter</cite> is a one-character string used to separate fields
in the CSV file, and <cite>quotechar</cite> is a one-character string used to
quote fields containing special characters in the CSV file. The default
values for these two arguments are suited for CSV files in Excel
format.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-21"><em>2.21</em></a>.</p>
<p>Design Part: 1.37</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_records_from_xls">
<tt class="descname">insert_records_from_xls</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_records_from_xls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_records_from_xls" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the records from a XLS file into the local database.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-21"><em>2.21</em></a>.</p>
<p>Design Part: TODO</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_species_from_csv">
<tt class="descname">insert_species_from_csv</tt><big>(</big><em>filename</em>, <em>delimiter=';'</em>, <em>quotechar='&quot;'</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_species_from_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_species_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the species from a CSV file into the local database.</p>
<p>Argument <cite>delimiter</cite> is a one-character string used to separate fields
in the CSV file, and <cite>quotechar</cite> is a one-character string used to
quote fields containing special characters in the CSV file. The default
values for these two arguments are suited for CSV files in Excel
format.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-19"><em>2.19</em></a>.</p>
<p>Design Part: 1.35</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.insert_species_from_xls">
<tt class="descname">insert_species_from_xls</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.insert_species_from_xls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.insert_species_from_xls" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the species from a XLS file into the local database.</p>
<p>For a description of the format for the localities file, refer
to <a class="reference internal" href="../design_parts_data.html#design-part-data-2-19"><em>2.19</em></a>.</p>
<p>Design Part: 1.35(b) TODO</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.remove_db_file">
<tt class="descname">remove_db_file</tt><big>(</big><em>tries=0</em><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.remove_db_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.remove_db_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the database file.</p>
<p>This method does three tries if for some reason the database file
could not be deleted (e.g. the file is in use by a different process).</p>
</dd></dl>

<dl class="method">
<dt id="setlyze.database.MakeLocalDB.run">
<tt class="descname">run</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#MakeLocalDB.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.MakeLocalDB.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide based on the configuration variables which functions should
be called.</p>
<p>This method first checks if SETLyze is configured to create a new local
database. This is done by checking the value of configuration
&#8220;make-new-db&#8221;. If this is set to False, nothing will be done. If set
to True, a new local database is created based on the value of the
&#8220;data-source&#8221; configuration:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">setl-database</span></tt></dt>
<dd>Method <a class="reference internal" href="#setlyze.database.MakeLocalDB.insert_from_db" title="setlyze.database.MakeLocalDB.insert_from_db"><tt class="xref py py-meth docutils literal"><span class="pre">insert_from_db()</span></tt></a> is called and some SETL data from the
remote SETL database is loaded into the local database.</dd>
<dt><tt class="docutils literal"><span class="pre">data-files</span></tt></dt>
<dd>Method <a class="reference internal" href="#setlyze.database.MakeLocalDB.insert_from_data_files" title="setlyze.database.MakeLocalDB.insert_from_data_files"><tt class="xref py py-meth docutils literal"><span class="pre">insert_from_data_files()</span></tt></a> is called which loads SETL data
from the user supplied data files into the local database.</dd>
</dl>
<p>Design Part: 1.31</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="setlyze.database.get_database_accessor">
<tt class="descclassname">setlyze.database.</tt><tt class="descname">get_database_accessor</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/setlyze/database.html#get_database_accessor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#setlyze.database.get_database_accessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an object that facilitates access to the database.</p>
<p>Based on the data source configuration, this function wil either
return an instance of <a class="reference internal" href="#setlyze.database.AccessLocalDB" title="setlyze.database.AccessLocalDB"><tt class="xref py py-class docutils literal"><span class="pre">AccessLocalDB</span></tt></a> or <a class="reference internal" href="#setlyze.database.AccessRemoteDB" title="setlyze.database.AccessRemoteDB"><tt class="xref py py-class docutils literal"><span class="pre">AccessRemoteDB</span></tt></a>.
This instance provides methods that are specific to the data source that
is in use.</p>
<p>Design Part: 1.93</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/setlyze-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">setlyze.database</span></tt> &#8212; Database access</a><ul>
<li><a class="reference internal" href="#module-setlyze.database">Module Contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="config.html"
                        title="previous chapter"><tt class="docutils literal"><span class="pre">setlyze.config</span></tt> &#8212; Configuration manager</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gui.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">setlyze.gui</span></tt> &#8212; Graphical interfaces</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/setlyze/database.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gui.html" title="setlyze.gui — Graphical interfaces"
             >next</a> |</li>
        <li class="right" >
          <a href="config.html" title="setlyze.config — Configuration manager"
             >previous</a> |</li>
    <li><a href="../gimaris.html">GiMaRIS</a> &raquo;</li>
    
        <li><a href="../index.html">SETLyze 1.0 documentation</a> &raquo;</li>

          <li><a href="../developer_guide.html" >SETLyze Developer Guide</a> &raquo;</li>
          <li><a href="../setlyze_modules.html" >SETLyze Standard Modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, 2011, GiMaRIS.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>